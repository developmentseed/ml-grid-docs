---
title: Downloading tiles
date: 2012-08-23
layout: post.html
---

To find all satellite imagery for each country, we first downloaded country boundaries from an online database of Global Administrative Areas (gadm.org). As Pakistan is has an ongoing border dispute, we confirmed that these borders matched those matched the internal records of the World Bank. From the country boundaries, we then calculated the indices of every satellite imagery tile that overlapped these borders at a specific zoom (or spatial resolution). Tile indices simply consist of 3 numbers: X, Y, and Zoom coordinates reflecting the spatial location and resolution of that tile. We obtained all relevant tiles for each country using a depth-first search algorithm: this algorithm keeps a queue of tile indices stored in a last-in-first-out stack. At each iteration, the top tile is removed, it’s spatial boundaries are computed, and the algorithm checks for spatial overlap between the tile boundaries and the country’s boundaries. If this overlap is nonzero, the algorithm computes the four sub-tiles of the original tile (i.e., zooming in a single increment) and adds these tiles to the stack. If, when the algorithm removes a tile index in the queue, it finds that this tile both (1) overlaps with the country boundary and (2) is at the specified zoom (here, 18), then it appends this tile index to a text file and deletes it from the queue. Once the queue is empty, the algorithm terminates leaving a text file with all tile indices at a specific zoom that cover the GeoJSON boundary. The advantage here is that it can process millions of tiles without ever storing more than about 40 tile indices in memory. This algorithm will be published as open source code after this project’s conclusion. In the interim, it is available in `gen_tile_inds.py` within the code repository.
